= git =

== 全局选项 ==

* core.autoctrlf=false
    - false 换行符不转换
    - true 检出时转CRLF，提交时转LF
    - input 提交时转LF，检出不变
* core.quotepath=false
    - true 非ASCII字符转义
    - false 非ASCII字符不转义(设置为这个!)
* core.ignorecase=false 
    - false 区分大小写(推荐配置这个，避免跨平台问题)
    - true 忽略大小写
* core.protectntfs=false 在windows上，Git可以保护NTFS特殊文件名(如：`CON` `PRN`)。
    - false 不启用保护
    - true 启用保护
* user.name 用户名
* user.email 提交记录中显示的邮箱
* include.path=C:/Users/xx/.git-mm/gitconfig 引入额外的配置文件，方便模块管理。
* http.sslverify=false 禁用 `SSL` 证书验证。这样可以避免证书错误，但是安全性降低。
* http.https://github.com.sslverify=false 和上面一样，只是针对特定网站。
* http.https://github.com.proxy 设置访问GitHub的代理服务器(带账号密码)
* https.https://github.com.proxy 和上面一样
* diff.tool=gvimdiff 默认差异比较工具是`gvimdiff`。
* difftool.prompt=false 使用差异工具时不提示确认。
* alias.d=difftool 定义命令别名：`git d`等价于`git difftool`。
* filter.lfs.required=true 启用Git LFS
* filter.lfs.clean=git-lfs clean -- %f 提交时调用LFS清理过滤器。
* filter.lfs.smudge=git-lfs smudge -- %f 检出时调用LFS替换过滤器。
* filter.lfs.process=git-lfs filter-process 使用LFS的进程过滤机制。
* gui.encoding=utf-8 Git GUI 使用UTF-8编码。
* i18n.commit.encoding=utf-8 提交信息编码为 UTF-8
* i18n.logoutputencoding=utf-8 日志输出编码为 UTF-8
* i18n.commitencoding=utf-8 提交信息的默认编码为 UTF-8




== 分支管理 ==

=== 拉取别人远程分支然后本地开发再推送自己的远程分支 ===

假设我的远程服务器是: `origin`，然后对方的是：`upstream`。

{{{bash
git fetch upstream change_type
git checkout -b change_type_2 upstream/change_type
git push -u origin change_type_2
}}}

如果对方的分支`change_type`有新的提交，我需要先合并到我自己的本地分支来。


{{{bash
git fetch upstream
git checkout change_type_2
git merge upstream/change_type
}}}

然后在推送到自己的远程。

{{{bash
git push origin change_type_2
}}}

如果要通过别人的远程分支更新自己的本地分支。

{{{bash
# 查看对方的远程分支是否在你的远程中
git remote -v
# 如果不在先添加
git remote add upstream <upstream仓库地址>
# 更新远程状态
git fetch upstream
# 切换到特性分支
git checkout xx
# 合并对方的提交(用于本地没有提交的情况)
git merge upstream/xx
# 让自己的提交在对方的提交之后
git rebase upstream/xx


# 如果有冲突，编辑冲突文件后
git add <冲突文件>
git rebase --continue   # 如果是 rebase
# 或者
git commit              # 如果是 merge
# 最后推送到自己的远程
git push origin xx
}}}

=== 显示每个分支跟踪的远程分支 ===

{{{bash
git branch -vv
}}}

这会显示每个本地分支对应的远程分支，并且显示落后/领先。


=== 添加fork作者的远程仓库 ===

{{{bash
git remote add upstream https://github.com/nkh/P5-App-Asciio
}}}

== 提交管理 ==

=== 压缩提交 ===

举例: 压缩最后的两个提交。

1. 启动交互式 rebase

{{{bash
git rebase -i HEAD~2
}}}

2. 编辑提交列表

{{{bash
pick abc123 最近的提交信息
pick def456 更早的提交信息
}}}

把第二个提交前的 pick 改成 squash（或简写 s）。

结果应该是：

{{{bash
pick abc123 最近的提交信息
s def456 更早的提交信息
}}}

3. 合并提交信息 保存后，Git 会提示编辑合并后的提交信息。可以选择保留两个提交信息，或者只留下一个。
4. 完成 rebase 编辑好提交信息后保存退出，Git 会把这两个提交压缩成一个新的提交。

== 合并管理 ==

=== 取消合并 ===

- 如果当前的合并还没有提交，那么直接用下面的指令

{{{bash
git merge --abort
}}}

或者

{{{bash
git reset --merge
}}}

- 如果当前的合并已经提交了，可以用下面的命令回退

{{{bash
git reset --hard HEAD~1
}}}

`reset --hard`会丢失没有保存的修改，在操作前最好先`git stash`保存下。

